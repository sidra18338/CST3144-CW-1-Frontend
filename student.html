<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lesson</title>
  <script src="https://cdn.jsdelivr.net/npm/vue@2.7.16/dist/vue.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f7f8fc;
      margin: 0;
      padding: 0;
      color: #333;
    }

    #app {
      background-image: url("Assets/background.jpeg"); /* Background image */
      background-size: cover;
      background-repeat: no-repeat;
      background-position: center;
      max-width: 800px;
      margin: auto;
      padding: 20px;
      color: #333;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: #4a90e2;
      padding: 10px;
      color: white;
      border-radius: 5px;
    }

    header h1 {
      font-size: 1.5em;
      margin: 0;
    }

    header button {
      background-color: #ff5a5f;
      border: none;
      color: white;
      padding: 8px 15px;
      font-size: 1em;
      border-radius: 5px;
      cursor: pointer;
    }

    header button:hover {
      background-color: #ff8080;
    }

    .search-bar input[type="text"] {
      width: 100%;
      padding: 10px;
      border-radius: 5px;
      border: 1px solid #ccc;
      font-size: 1em;
      box-sizing: border-box;
    }

    .sorting-options {
      margin: 20px 0;
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
      padding: 10px;
      background-color: #eef3f9;
      border-radius: 5px;
    }

    .lesson-info {
      display: flex;
      align-items: center;
      background-color: white;
      padding: 15px;
      margin: 10px 0;
      border-radius: 5px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .lesson-image img {
      border-radius: 5px;
      margin-right: 15px;
    }

    .lesson-details h2 {
      margin: 0;
      font-size: 1.2em;
      color: #333;
    }

    .lesson-details button {
      background-color: #4a90e2;
      border: none;
      color: white;
      padding: 8px 12px;
      font-size: 0.9em;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 10px;
    }

    .lesson-details button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
    }

    h2 {
      font-size: 1.5em;
      color: #4a90e2;
    }

    .checkout-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: #f1f3f5;
      padding: 10px;
      border-radius: 5px;
      margin-bottom: 10px;
    }

    .checkout-item button:hover {
      background-color: #ff8080;
    }

    button {
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div id="app">
    <header>
      <h1 v-text="sitename"></h1>
      <button v-on:click="showCheckout">
        {{ cartItemCount }}
        <span class="fas fa-cart-plus"></span> Checkout
      </button>
    </header>

    <div v-if="showProduct">
      <main class="lesson-container">
        <div class="search-bar">
          <input 
            type="text" 
            v-model="searchQuery" 
            placeholder="Search lessons..." 
            @input="liveSearch"
          />
        </div>

        <div class="sorting-options">
          <p>Sort by:</p>
          <label>
            <input type="radio" v-model="sortBy" value="subject" /> Subject
          </label>
          <label>
            <input type="radio" v-model="sortBy" value="price" /> Price
          </label>
          <label>
            <input type="radio" v-model="sortBy" value="Location" /> Location
          </label>

          <p>Order:</p>
          <label>
            <input type="radio" v-model="sortOrder" value="asc" /> Ascending
          </label>
          <label>
            <input type="radio" v-model="sortOrder" value="desc" /> Descending
          </label>
        </div>

        <div v-for="lesson in sortedAndFilteredLessons" :key="lesson.id" class="lesson-info">
          <figure class="lesson-image">
            <img :src="lesson.image" :alt="lesson.subject + ' Lesson Image'" style="width: 150px; height: auto; object-fit: cover;" @error="imageError" />
          </figure>
          <div class="lesson-details">
            <h2 v-text="lesson.subject"></h2>
            <p v-text="lesson.Location"></p>
            <p>Price: {{ lesson.price }}</p>
            <p>Available spaces: {{ lesson.availableInventory }}</p>
            <button v-on:click="addToCart(lesson)" v-if="lesson.availableInventory > 0">Add to cart</button>
            <button disabled v-else>Add to cart</button>
          </div>
        </div>
      </main>
    </div>
    
    <div v-else>
      <h2>Checkout</h2>
      <div v-for="lesson in cartItems" :key="lesson.id" class="checkout-item">
        <span>{{ lesson.subject }} - {{ lesson.price }}</span>
        <button v-on:click="removeFromCart(lesson)">Remove from cart</button>
      </div>
      <p>You have {{ cartItemCount }} items in your cart.</p>
      <button v-on:click="showCheckout">Go back to product</button>
    </div>
  </div>

  <script type="text/javascript">
    new Vue({
      el: '#app',
      data: {
        sitename: "After School Club",
        searchQuery: "",
        sortBy: "subject",
        sortOrder: "asc",
        lessons: [
          {
            id: 1,
            subject: "Math",
            Location: "Dubai",
            price: 2000,
            image: "Assets/maths.jpeg",
            availableInventory: 6
          },
          {
            id: 2,
            subject: "English",
            Location: "Sharjah",
            price: 1000,
            image: "Assets/english.avif",
            availableInventory: 9
          },
          {
            id: 3,
            subject: "Music",
            Location: "Ajman",
            price: 4980,
            image: "Assets/music.jpg",
            availableInventory: 4
          },
          {
            id: 4,
            subject: "Cricket",
            Location: "Abu Dhabi",
            price: 1950,
            image: "Assests\cricket.png",
            availableInventory: 10
          }
        ],
        cart: [],
        showProduct: true
      },
      methods: {
        addToCart(lesson) {
          if (lesson.availableInventory > 0) {
            this.cart.push(lesson.id);
            lesson.availableInventory--;
          }
        },
        removeFromCart(lesson) {
          const index = this.cart.indexOf(lesson.id);
          if (index !== -1) {
            this.cart.splice(index, 1);
            lesson.availableInventory++;
          }
        },
        showCheckout() {
          this.showProduct = !this.showProduct;
        },
        liveSearch() {
          // Live search is handled by the computed property
        },
        
      },
      computed: {
        cartItemCount() {
          return this.cart.length || "";
        },
        cartItems() {
          return this.lessons.filter(lesson => this.cart.includes(lesson.id));
        },
        sortedAndFilteredLessons() {
          let filteredLessons = this.lessons.filter(lesson =>
            lesson.subject.toLowerCase().includes(this.searchQuery.toLowerCase()) ||
            lesson.Location.toLowerCase().includes(this.searchQuery.toLowerCase())
          );

          let modifier = this.sortOrder === 'asc' ? 1 : -1;
          return filteredLessons.sort((a, b) => {
            if (this.sortBy === 'subject') {
              return modifier * a.subject.localeCompare(b.subject);
            } else if (this.sortBy === 'price') {
              return modifier * (a.price - b.price);
            } else if (this.sortBy === 'Location') {
              return modifier * a.Location.localeCompare(b.Location);
            }
          });
        }
      }
    });
  </script>
</body>
</html